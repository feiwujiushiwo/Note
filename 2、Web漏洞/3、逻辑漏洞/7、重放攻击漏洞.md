# 重放攻击漏洞

## 1、概述

### 1.1、重放攻击

攻击者可以通过记录请求数据并多次重新提交实现重放攻击，当网站未对重放攻击进行合理防护时可能会出现逻辑漏洞。

- 重放退款请求造成多次退款
- 重放投票数据造成重复刷票
- 重放订单下单操作，锁定大量商品资源

> Tips：
>
> 有时，重放攻击还与条件竞争漏洞结合，通过短时间内多次重放来造成具体危害。

## 2、漏洞防御

| 防御措施           | 描述                                                         |
| ------------------ | ------------------------------------------------------------ |
| 唯一标识符和令牌   | 每个请求包含唯一标识符或令牌，服务器验证标识符是否已被使用。 |
| 时间戳和过期时间   | 请求包含时间戳和有效期，服务器校验请求是否在有效时间内。     |
| 限制请求次数和频率 | 限制特定类型请求的执行次数和频率，防止过多重复请求。         |
| 加密和数字签名     | 使用加密和数字签名保护数据完整性和真实性。                   |
| 使用验证码或OTP    | 在关键操作中使用验证码或一次性口令进行额外确认。             |
| 审计和监控         | 建立审计日志并监控异常行为，及时发现并应对异常请求。         |
